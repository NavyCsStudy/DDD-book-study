# 1. 도메인 모델 시작하기

## 1.1 도메인이란?
- 도메인 : 소프트웨어로 해결하고자하는 문제 영역
- 도메인은 하위 도메인으로 나눌 수 있음
- 도메인이 제공해야하 할 모든 기능을 직접 구현하는 것은 아님
  - 일부 기능은 자체 시스템으로 구현하고 나머지 기능은 외부 업체의 시스템을 사용 ex) 외부 PG
- 도메인마다 고정된 하위 도메인이 존재하는 것은 아님
  - 소규모 업체는 엑셀 같은 도구로 수작업으로 정산

## 1.2 도메인 전문가와 개발자 간 지식 공유
- 개발자는 각 분야의 전문가들의 요구사항을 분석하고 설계하여 코드를 작성하고 테스트하고 배포
- 요구사항을 올바르게 이해하는 것이 중요

## 1.3 도메인 모델
- 도메인 모델 : 특정 도메인을 개념적으로 표현한 것. 도메인 자체를 이해하기 위한 개념 모델
- 도메인 모델의 종류
  - 객체 모델
  - 상태 다이어그램
  - 그래프 모델
- 도메인 모델을 사용하면 여러 관계자들이 동일한 모습으로 도메인을 이해하고 도메인 지식을 공유할 수 있음
- 구현 모델 : 구현 기술에 맞는 도메인 모델

## 1.4 도메인 모델 패턴
- 도메인 모델 패턴 : 아키텍처 상의 도메인 계층을 객체 지향 기법으로 구현한 패턴
- 애플리케이션 아키텍처 : (사용자) - 표현 - 응용 - 도메인 - 인프라스트럭처 - DB
  - 표현(UI) : 사용자의 요청을 처리하고 정보를 보여줌. 사용자는 사람 또는 외부 시스템
  - 응용 : 사용자가 요청한 기능을 수행. 업무 로직을 구현하지 않고 도메인 계층을 조합하여 기능을 실행
  - 도메인 : 시스템이 제공할 도메인 규칙 구현, 도메인의 핵심 규칙을 구현 -> 규칙의 변경이 발생했을 때 도메인 계층에만 반영
  - 인프라스트럭처 : DB나 메시징 시스템과 같은 외부 시스템과의 연동

## 1.5 도메인 모델 도출
- 초기 작업 : 요구사항으로부터 모델을 구성하는 핵심 구성 요소, 규칙, 기능을 찾는 것
  ex) 출고 전에 주문을 취소할 수 있다.
  - 주문은 출고 전/후의 상태를 갖음
  - 취소 요청 시 주문 상태를 통해 출고 전인지를 검증해야함

## 1.6 엔티티와 밸류
- 도출한 모델은 엔티티와 밸류로 구분
  - 엔티티 ex) 주문(Order)
    - 식별자를 가짐 ex) 주문 번호
    - 식별자는 불변
    - 식별자는 도메인의 특징과 사용 기술에 따라 다름
      ex) 주문번호를 날짜와 시간을 이용해서 생성, 회원의 아이디는 사용자가 직접 입력
    - 식별자를 밸류 타입으로 사용하기도 함 ex) OrderNo
  - 밸류 ex) 배송 정보(ShippingInfo)
    - 개념적으로 완전한 하나를 표현할 때 사용 ex) 배송 정보 - 받는 사람, 받는 사람 번호, 주소
    - 밸류 타입은 하나 이상의 값을 갖는다 ex) Money 밸류 타입은 int 타입의 돈이라는 값만 가짐
    - 밸류 타입을 위한 기능을 추가할 수 있음 ex) Money 밸류 타입에 add 메서드를 통해 돈 계산을 위한 기능을 추가할 수 있음
    - 밸류 객체는 불변으로 구현해야 안전함
      ex) 불변이 아닐 경우, OrderLine 을 생성할 때 Money 객체를 넘겨주고 이후에 외부에서 Money 객체의 값이 변경된다면, OrderLine 은 변경 전의 Money 객체와 관련된 값을 갖게 됨 
    - 밸류 객체를 비교할 땐 모든 속성이 같은 지 비교
- get/set 메서드는 지양하는게 좋음
  - set 메서드의 단점
    - 필드값만 변경하고 끝나기 때문에 상태 변경과 관련된 도메인 지식이 코드에서 사라짐
    - 도메인 객체를 생성할 때 온전하지 않은 상태가 될 수 있음 -> 필요한 정보가 null 로 설정
  - dto 는 도메인 로직을 담고 있지 않기 때문에 get/set 을 사용해도 도메인 객체의 일관성에 영향을 주지 않음

## 1.7 도메인 용어와 유비쿼터스 언어
- 코드를 작성할 때 도메인에서 사용하는 언어를 사용해야함
  - 코드를 도메인 용어로 해석하거나 도메인 용어를 코드로 해석하지 않아도 됨
  - 코드의 가독성을 높이고 코드를 분석하고 이해하는 시간을 줄여줌